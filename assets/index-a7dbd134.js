(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))h(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const f of t.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&h(f)}).observe(document,{childList:!0,subtree:!0});function s(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function h(o){if(o.ep)return;o.ep=!0;const t=s(o);fetch(o.href,t)}})();const l=document.querySelector("canvas"),r=l.getContext("2d");window.addEventListener("resize",()=>{l.width=window.innerWidth,l.height=window.innerHeight});window.dispatchEvent(new Event("resize"));const u=50,v=100,i=30,T=250,_=3e3,a=[];let d="running",S=()=>{};setInterval(()=>{d==="running"&&a.push({x:l.width,y:Math.random()>.5?0:-1})},_);let m=1,y,p,g;const c=[];let L=0,b=0;document.querySelector("#players_count input").addEventListener("change",({target:e})=>{m=e.checked?2:1});const w=e=>{if(S(),d!=="running"){b=performance.now(),d="running",requestAnimationFrame(P);return}const n=c[e]??c[0];n&&Math.abs(n.state)!==1&&(n.state=n.state===2?-1:1)};addEventListener("keydown",e=>{e.code==="Space"?w(0):e.code==="Enter"&&w(1)});addEventListener("pointerdown",({target:e,clientX:n})=>{e.tagName.toLowerCase()==="canvas"&&(n<l.width/2?w(0):w(1))});const E=[];let I;const F=()=>{I=setInterval(()=>{for(const[e,n]of E.entries())n.buttons&&w(e)},100)};addEventListener("gamepadconnected",({gamepad:e})=>{E.push(e),F()});removeEventListener("gamepaddisconnected",({gamepad:e})=>{E.splice(E.indexOf(e),1),E.length===0&&clearInterval(I)});const q=e=>{const{color:n,y:s}=e;r.fillStyle=n,r.beginPath(),r.arc(v,s,i,0,Math.PI*2),r.fill(),r.strokeStyle=n,r.strokeRect(v-i,s-i,i*2,i*2)},N=()=>{r.fillStyle="limegreen";for(const e of[p,g])r.fillRect(0,e,l.width,2)},B=()=>{r.fillStyle="red";for(const e of a)r.fillRect(e.x,e.y<0?g-u:p,u,u)},C=(e,n,s,h)=>e<=h&&n>=s,M=.3,j=1,x=e=>{d=e?"gameover":"paused",e&&(S=()=>{a.splice(0,a.length),L=0,S=()=>{}})},G=()=>{const e=d==="gameover";let n=60;r.font=`${n}px sans-serif`,r.fillStyle=e?"red":"lightgreen";let s=e?"Game Over":"Paused";r.fillText(s,(l.width-r.measureText(s).width)/2,y-n/2),n=30,r.font=`${n}px sans-serif`,s="Click or press space to continue",r.fillText(s,(l.width-r.measureText(s).width)/2,y+n/2)};window.addEventListener("blur",()=>{d==="running"&&x(!1)});const Y=e=>{y=l.height/2,g=y+T/2,p=y-T/2;const n=e-b;b=e;const s=n*M;for(let t=0;t<a.length;t++){a[t].x-=s*j;const{x:f,y:R}=a[t],O=R>=0?p:g-u;for(const{y:A}of c)if(C(O,O+u,A-i,A+i)&&C(f,f+u,v-i,v+i)){x(!0);return}f<=-u&&(a.splice(t,1),t--,L++)}const h=g-i,o=p+i;for(const t of c)Math.abs(t.state)===1?(t.y+=t.state*s,t.y>=h&&(t.state=2),t.y<=o&&(t.state=-2)):t.y=t.state===2?g-i:p+i},z=()=>{if(c.length<m)for(let e=c.length;e<m;e++)c.push({state:e%2?2:-2,y:e%2?g-i:p+i,color:e?"dodgerblue":"deepskyblue"});else c.length>m&&c.splice(m,c.length-m);for(const e of c)q(e)},D=()=>{r.font="20px sans-serif",r.fillStyle="white",r.fillText(`Score: ${L}`,0,50)},P=e=>{d==="running"&&Y(e),r.clearRect(0,0,l.width,l.height),N(),z(),B(),D(),d!=="running"&&G(),requestAnimationFrame(P)};requestAnimationFrame(e=>{P(e),x(!1)});
